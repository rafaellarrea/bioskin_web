<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Blogs Vercel</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .blog { border: 1px solid #ccc; margin: 10px; padding: 15px; border-radius: 5px; }
        .loading { color: #666; font-style: italic; }
        .error { color: red; }
        .success { color: green; }
        .organized { background-color: #e8f5e8; }
        .legacy { background-color: #f5f5e8; }
        pre { background: #f4f4f4; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üß™ Test de Blogs en Vercel</h1>
    <p>Verificando si los blogs est√°n disponibles en el sitio desplegado...</p>
    
    <div id="status" class="loading">Cargando blogs...</div>
    
    <h2>üìä Estad√≠sticas</h2>
    <div id="stats"></div>
    
    <h2>üìù Blogs Encontrados</h2>
    <div id="blogs"></div>
    
    <h2>üîç Debug Info</h2>
    <pre id="debug"></pre>

    <script>
        async function testBlogs() {
            const statusDiv = document.getElementById('status');
            const blogsDiv = document.getElementById('blogs');
            const statsDiv = document.getElementById('stats');
            const debugDiv = document.getElementById('debug');
            
            try {
                statusDiv.innerHTML = 'üîÑ Probando endpoint json-files...';
                
                // Probar el endpoint de archivos JSON
                const response = await fetch('/api/blogs/json-files');
                const data = await response.json();
                
                debugDiv.textContent = JSON.stringify(data, null, 2);
                
                if (data.success) {
                    statusDiv.innerHTML = `‚úÖ <span class="success">Endpoint funcionando!</span>`;
                    
                    // Mostrar estad√≠sticas
                    statsDiv.innerHTML = `
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                            <div><strong>Total blogs:</strong> ${data.blogs.length}</div>
                            <div><strong>Organizados:</strong> ${data.stats.organized || 0}</div>
                            <div><strong>Legacy:</strong> ${data.stats.legacy || 0}</div>
                            <div><strong>En √≠ndice:</strong> ${data.stats.totalBlogs || 0}</div>
                        </div>
                    `;
                    
                    // Mostrar blogs
                    data.blogs.forEach(blog => {
                        const isOrganized = blog.source?.includes('organized');
                        const blogDiv = document.createElement('div');
                        blogDiv.className = `blog ${isOrganized ? 'organized' : 'legacy'}`;
                        blogDiv.innerHTML = `
                            <h3>${blog.title}</h3>
                            <p><strong>Slug:</strong> ${blog.slug}</p>
                            <p><strong>Tipo:</strong> ${blog.source} ${isOrganized ? 'üóÇÔ∏è' : 'üìÑ'}</p>
                            <p><strong>Categor√≠a:</strong> ${blog.category}</p>
                            <p><strong>Autor:</strong> ${blog.author}</p>
                            <p><strong>Fecha:</strong> ${new Date(blog.publishedAt).toLocaleDateString('es-ES')}</p>
                            <p><strong>Imagen:</strong> ${blog.image}</p>
                            ${blog.excerpt ? `<p><em>${blog.excerpt.substring(0, 150)}...</em></p>` : ''}
                        `;
                        blogsDiv.appendChild(blogDiv);
                    });
                    
                    // Probar espec√≠ficamente el blog organizado
                    const organizedBlog = data.blogs.find(b => b.slug === 'peeling-quimico-vs-tratamientos-laser-cual-es-la-mejor-opcion-para-tu-piel');
                    if (organizedBlog) {
                        statusDiv.innerHTML += `<br>üéØ <span class="success">Blog organizado encontrado!</span>`;
                    } else {
                        statusDiv.innerHTML += `<br>‚ö†Ô∏è Blog organizado NO encontrado`;
                    }
                    
                } else {
                    statusDiv.innerHTML = `‚ùå <span class="error">Error: ${data.message}</span>`;
                }
                
            } catch (error) {
                statusDiv.innerHTML = `‚ùå <span class="error">Error de conexi√≥n: ${error.message}</span>`;
                debugDiv.textContent = `Error: ${error.stack}`;
            }
        }
        
        // Ejecutar al cargar la p√°gina
        testBlogs();
        
        // Actualizar cada 30 segundos
        setInterval(testBlogs, 30000);
    </script>
</body>
</html>